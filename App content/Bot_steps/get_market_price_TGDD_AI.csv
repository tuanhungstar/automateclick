__SCHEDULE_INFO__
{}
__GLOBAL_VARIABLES__
Chrome_link,"""C:/Users/puu1hc/OneDrive - Bosch Group/PersonalDrive/BOT 2023 Version/Auto-classify-new-2023/chromedriver-win64/chromedriver.exe"""
url,"""https://www.dienmayxanh.com/tu-lanh/hitachi-inverter-573-lit-r-sx800gpgv0"""
_webdriver,null
Desc,null
_price,null
_workbook,null
_total_line,999
_interate,2
_row,3
_product_search,"""T\u1ee7 l\u1ea1nh Hitachi R-SX800GPGV0 GBK"""
df_search,null
product_price,"""48.500.000\u20ab"""
product_description,"""T\u1ee7 l\u1ea1nh Hitachi Inverter 573 l\u00edt Side By Side R-SX800GPGV0 GBK"""
col_price,"""I"""
col_des,"""J"""
stt,"""GGAPI2"""
_screenshot_file_name,"""C:\\Users\\puu1hc\\OneDrive - Bosch Group\\Automationtool\\TGDD\\screenshot\\dmx_GGAPI2.png"""
screenshot_folder_link,"""C:\\Users\\puu1hc\\OneDrive - Bosch Group\\Automationtool\\TGDD\\screenshot"""
isTakescreenshot,true
col_screenshot,"""M"""
col_link,"""L"""
gemini_result_df,null
_json_gemini,"""```json\n{\n  \""product_name\"": \""T\u1ee7 l\u1ea1nh Hitachi Inverter 573 l\u00edt Side By Side R-SX800GPGV0 GBK\"",\n  \""price\"": \""48.500.000\u20ab\"",\n  \""status\"": \""C\u00f2n h\u00e0ng\""\n}\n```"""
excel_link,"""C:/Users/puu1hc/OneDrive - Bosch Group/Automationtool/TGDD/TGGD partlist _ newT.xlsx"""
cells_price_value,null
last_run_row,1
hyper_link,"""=HYPERLINK(\""C:\\Users\\puu1hc\\OneDrive - Bosch Group\\Automationtool\\TGDD\\screenshot\\dmx_GGAPI2.png\"")"""
__BOT_STEPS__
StepType,DataJSON
step,"{""assign_to_variable_name"": ""_workbook"", ""class_name"": ""handle_excel"", ""method_name"": ""read_excel"", ""module_name"": ""File_ReadWrite"", ""parameters_config"": {""file_link"": {""type"": ""variable"", ""value"": ""excel_link""}, ""sheet_name"": {""type"": ""hardcoded"", ""value"": null}}, ""type"": ""step"", ""workflow_pos"": [1300, 50]}"
step,"{""assign_to_variable_name"": ""_total_line"", ""class_name"": ""handle_excel"", ""method_name"": ""count_non_empty_rows_in_column"", ""module_name"": ""File_ReadWrite"", ""parameters_config"": {""column_identifier"": {""type"": ""hardcoded"", ""value"": ""D""}, ""workbook"": {""type"": ""variable"", ""value"": ""_workbook""}}, ""type"": ""step"", ""workflow_pos"": [1300, 170]}"
step,"{""assign_to_variable_name"": ""last_run_row"", ""class_name"": ""handle_excel"", ""method_name"": ""count_non_empty_rows_in_column"", ""module_name"": ""File_ReadWrite"", ""parameters_config"": {""column_identifier"": {""type"": ""variable"", ""value"": ""col_price""}, ""workbook"": {""type"": ""variable"", ""value"": ""_workbook""}}, ""type"": ""step"", ""workflow_pos"": [1300, 290]}"
loop_start,"{""loop_config"": {""loop_name"": null, ""iteration_count_config"": {""type"": ""hardcoded"", ""value"": 2}, ""assign_iteration_to_variable"": ""_interate""}, ""loop_id"": ""loop_1"", ""type"": ""loop_start"", ""workflow_pos"": [1300, 410]}"
step,"{""assign_to_variable_name"": ""_row"", ""class_name"": ""change_variable_value"", ""method_name"": ""math_add_variable"", ""module_name"": ""Variable_manipulation"", ""parameters_config"": {""var1"": {""type"": ""variable"", ""value"": ""_interate""}, ""var2"": {""type"": ""variable"", ""value"": ""last_run_row""}}, ""type"": ""step"", ""workflow_pos"": [1234, 530]}"
step,"{""assign_to_variable_name"": ""cells_price_value"", ""class_name"": ""handle_excel"", ""method_name"": ""read_excel_cells"", ""module_name"": ""File_ReadWrite"", ""parameters_config"": {""col"": {""type"": ""variable"", ""value"": ""col_price""}, ""row"": {""type"": ""variable"", ""value"": ""_row""}, ""workbook"": {""type"": ""variable"", ""value"": ""_workbook""}}, ""type"": ""step"", ""workflow_pos"": [1234, 650]}"
IF_START,"{""condition_config"": {""block_name"": null, ""condition"": {""left_operand"": {""type"": ""variable"", ""value"": ""cells_price_value""}, ""operator"": ""=="", ""right_operand"": {""type"": ""hardcoded"", ""value"": null}}}, ""if_id"": ""if_4"", ""type"": ""IF_START"", ""workflow_pos"": [1234, 770]}"
step,"{""assign_to_variable_name"": ""stt"", ""class_name"": ""handle_excel"", ""method_name"": ""read_excel_cells"", ""module_name"": ""File_ReadWrite"", ""parameters_config"": {""col"": {""type"": ""hardcoded"", ""value"": ""A""}, ""row"": {""type"": ""variable"", ""value"": ""_row""}, ""workbook"": {""type"": ""variable"", ""value"": ""_workbook""}}, ""type"": ""step"", ""workflow_pos"": [904, 890]}"
step,"{""assign_to_variable_name"": ""_product_search"", ""class_name"": ""handle_excel"", ""method_name"": ""read_excel_cells"", ""module_name"": ""File_ReadWrite"", ""parameters_config"": {""col"": {""type"": ""hardcoded"", ""value"": ""E""}, ""row"": {""type"": ""variable"", ""value"": ""_row""}, ""workbook"": {""type"": ""variable"", ""value"": ""_workbook""}}, ""type"": ""step"", ""workflow_pos"": [904, 1010]}"
step,"{""assign_to_variable_name"": ""df_search"", ""class_name"": ""Google_cloud"", ""method_name"": ""search_google"", ""module_name"": ""Google_cloud"", ""parameters_config"": {""api_key"": {""type"": ""hardcoded"", ""value"": ""AIzaSyDcI4Dya15MwEeprPsM28PHbKq_eBZwzB8""}, ""product_name"": {""type"": ""variable"", ""value"": ""_product_search""}, ""proxy_config"": {""type"": ""hardcoded"", ""value"": ""{'https': 'rb-proxy-de.bosch.com:8080'}""}, ""search_engine_id"": {""type"": ""hardcoded"", ""value"": ""024aceea33b694611""}}, ""type"": ""step"", ""workflow_pos"": [904, 1130]}"
step,"{""assign_to_variable_name"": null, ""class_name"": ""Code_Executor"", ""custom_config_method"": ""configure_data_hub"", ""method_name"": ""_execute_python_code"", ""module_name"": ""Script"", ""parameters_config"": {""config_data"": {""type"": ""hardcoded"", ""value"": {""code_string"": ""import pandas as pd\n\ndf = context.get_variable('df_search')\ndf_filter = df[df['link'].str.contains('dienmayxanh')|df['link'].str.contains('thegioididong')].copy()\n\nif len(df_filter)>0:\n\turl = df_filter['link'].values[0]\nelse:\n\turl =''\n\ncontext.set_variable('url', url)"", ""imported_module_path"": null}}}, ""type"": ""step"", ""workflow_pos"": [904, 1250]}"
IF_START,"{""condition_config"": {""block_name"": null, ""condition"": {""left_operand"": {""type"": ""variable"", ""value"": ""url""}, ""operator"": ""is not"", ""right_operand"": {""type"": ""hardcoded"", ""value"": """"}}}, ""if_id"": ""if_5"", ""type"": ""IF_START"", ""workflow_pos"": [904, 1370]}"
step,"{""assign_to_variable_name"": ""_webdriver"", ""class_name"": ""Chrome_selenium"", ""method_name"": ""connect_chrome"", ""module_name"": ""Chrome_selenium"", ""parameters_config"": {""chrome_driver_link"": {""type"": ""variable"", ""value"": ""Chrome_link""}, ""url"": {""type"": ""variable"", ""value"": ""url""}}, ""type"": ""step"", ""workflow_pos"": [574, 1490]}"
step,"{""assign_to_variable_name"": null, ""class_name"": ""Code_Executor"", ""custom_config_method"": ""configure_data_hub"", ""method_name"": ""_execute_python_code"", ""module_name"": ""Script"", ""parameters_config"": {""config_data"": {""type"": ""hardcoded"", ""value"": {""code_string"": ""file_name = context.get_variable('stt')\nfoler_link = context.get_variable('screenshot_folder_link')\nfile_name = foler_link +'\\\\dmx_' + file_name +'.png'\ncontext.set_variable('_screenshot_file_name', file_name)\n"", ""imported_module_path"": null}}}, ""type"": ""step"", ""workflow_pos"": [574, 1610]}"
step,"{""assign_to_variable_name"": ""isTakescreenshot"", ""class_name"": ""Chrome_TGDD"", ""method_name"": ""take_screenshot"", ""module_name"": ""Chrome_selenium"", ""parameters_config"": {""driver"": {""type"": ""variable"", ""value"": ""_webdriver""}, ""file_link"": {""type"": ""variable"", ""value"": ""_screenshot_file_name""}}, ""type"": ""step"", ""workflow_pos"": [574, 1730]}"
IF_START,"{""condition_config"": {""block_name"": null, ""condition"": {""left_operand"": {""type"": ""variable"", ""value"": ""isTakescreenshot""}, ""operator"": ""=="", ""right_operand"": {""type"": ""hardcoded"", ""value"": true}}}, ""if_id"": ""if_3"", ""type"": ""IF_START"", ""workflow_pos"": [574, 1850]}"
step,"{""type"": ""step"", ""class_name"": ""Code_Executor"", ""method_name"": ""_execute_python_code"", ""module_name"": ""Script"", ""parameters_config"": {""config_data"": {""type"": ""hardcoded"", ""value"": {""code_string"": ""text = context.get_variable('_screenshot_file_name')\n\nhyperlink = f'''=HYPERLINK(\""{text}\"")'''\ncontext.set_variable('hyper_link', hyperlink)"", ""imported_module_path"": null}}}, ""assign_to_variable_name"": null, ""custom_config_method"": ""configure_data_hub"", ""workflow_pos"": [244, 1970]}"
step,"{""assign_to_variable_name"": null, ""class_name"": ""handle_excel"", ""method_name"": ""write_excel_cells"", ""module_name"": ""File_ReadWrite"", ""parameters_config"": {""workbook"": {""type"": ""variable"", ""value"": ""_workbook""}, ""col"": {""type"": ""variable"", ""value"": ""col_screenshot""}, ""row"": {""type"": ""variable"", ""value"": ""_row""}, ""value"": {""type"": ""variable"", ""value"": ""hyper_link""}}, ""type"": ""step"", ""workflow_pos"": [244, 2090]}"
ELSE,"{""condition_config"": {""block_name"": null, ""condition"": {""left_operand"": {""type"": ""variable"", ""value"": ""isTakescreenshot""}, ""operator"": ""=="", ""right_operand"": {""type"": ""hardcoded"", ""value"": true}}}, ""if_id"": ""if_3"", ""type"": ""ELSE""}"
step,"{""assign_to_variable_name"": null, ""class_name"": ""Bot_Flow_Control"", ""method_name"": ""stop_workflow"", ""module_name"": ""Bot_GUI_Control"", ""parameters_config"": {}, ""type"": ""step"", ""workflow_pos"": [838, 1970]}"
IF_END,"{""condition_config"": {""block_name"": null, ""condition"": {""left_operand"": {""type"": ""variable"", ""value"": ""isTakescreenshot""}, ""operator"": ""=="", ""right_operand"": {""type"": ""hardcoded"", ""value"": true}}}, ""if_id"": ""if_3"", ""type"": ""IF_END"", ""workflow_pos"": [574, 2250]}"
step,"{""assign_to_variable_name"": ""gemini_result_df"", ""class_name"": ""Gemini_API"", ""custom_config_method"": ""configure_data_hub"", ""method_name"": ""_execute_gemini_call"", ""module_name"": ""API Request"", ""parameters_config"": {""config_data"": {""type"": ""hardcoded"", ""value"": {""api_key"": ""d70746b9c0d549f5a9b4148a422bd321"", ""file_path_config"": {""type"": ""variable"", ""value"": ""_screenshot_file_name""}, ""prompt_type"": ""text"", ""prompt_value"": ""give me product price and product description in json format like this \""\""\""\n{\n  \""product_name\"": \""Smart Tivi Neo QLED 8K 65 inch Samsung QA65QN900A\"",\n  \""price\"": \""45.590.000\u20ab\""\n  \""status\"": \""S\u1ea2N PH\u1ea8M NG\u1eeaNG KINH DOANH\""\n}\n\""\""\"""", ""proxies"": ""http://127.0.0.1:3128"", ""url"": ""https://aoai-farm.bosch-temp.com/api/openai/deployments/google-gemini-2-0-flash-lite/chat/completions""}}}, ""type"": ""step"", ""workflow_pos"": [574, 2370]}"
step,"{""assign_to_variable_name"": ""_json_gemini"", ""class_name"": ""DataFrame"", ""method_name"": ""read_cell"", ""module_name"": ""Pandas Lib"", ""parameters_config"": {""col_idx"": {""type"": ""hardcoded"", ""value"": 8}, ""df"": {""type"": ""variable"", ""value"": ""gemini_result_df""}, ""row_idx"": {""type"": ""hardcoded"", ""value"": 0}}, ""type"": ""step"", ""workflow_pos"": [574, 2490]}"
step,"{""assign_to_variable_name"": null, ""class_name"": ""Code_Executor"", ""custom_config_method"": ""configure_data_hub"", ""method_name"": ""_execute_python_code"", ""module_name"": ""Script"", ""parameters_config"": {""config_data"": {""type"": ""hardcoded"", ""value"": {""code_string"": ""import pandas as pd\nimport json\n\ntext =context.get_variable('_json_gemini')\ntext = text.replace(\""```\"",\""\"").replace(\""json\"",\""\"")\ndata = json.loads(text)\ndf = pd.DataFrame([data])\nif len(df)>0:\n\tprice = df['price'].values[0]\nelse:\n\tprice = 'not found'\n\ncontext.set_variable('product_price', price)\n"", ""imported_module_path"": null}}}, ""type"": ""step"", ""workflow_pos"": [574, 2610]}"
step,"{""assign_to_variable_name"": null, ""class_name"": ""Code_Executor"", ""custom_config_method"": ""configure_data_hub"", ""method_name"": ""_execute_python_code"", ""module_name"": ""Script"", ""parameters_config"": {""config_data"": {""type"": ""hardcoded"", ""value"": {""code_string"": ""import pandas as pd\nimport json\n\ntext =context.get_variable('_json_gemini')\ntext = text.replace(\""```\"",\""\"").replace(\""json\"",\""\"")\ndata = json.loads(text)\ndf = pd.DataFrame([data])\nif len(df)>0:\n\tprd_name = df['product_name'].values[0]\nelse:\n\tprd_name = 'not found'\n\ncontext.set_variable('product_description', prd_name)\n"", ""imported_module_path"": null}}}, ""type"": ""step"", ""workflow_pos"": [574, 2730]}"
step,"{""assign_to_variable_name"": null, ""class_name"": ""handle_excel"", ""method_name"": ""write_excel_cells"", ""module_name"": ""File_ReadWrite"", ""parameters_config"": {""workbook"": {""type"": ""variable"", ""value"": ""_workbook""}, ""col"": {""type"": ""variable"", ""value"": ""col_price""}, ""row"": {""type"": ""variable"", ""value"": ""_row""}, ""value"": {""type"": ""variable"", ""value"": ""product_price""}}, ""type"": ""step"", ""workflow_pos"": [574, 2850]}"
step,"{""type"": ""step"", ""class_name"": ""handle_excel"", ""method_name"": ""write_excel_cells"", ""module_name"": ""File_ReadWrite"", ""parameters_config"": {""workbook"": {""type"": ""variable"", ""value"": ""_workbook""}, ""col"": {""type"": ""variable"", ""value"": ""col_des""}, ""row"": {""type"": ""variable"", ""value"": ""_row""}, ""value"": {""type"": ""variable"", ""value"": ""product_description""}}, ""assign_to_variable_name"": null, ""workflow_pos"": [574, 2970]}"
step,"{""type"": ""step"", ""class_name"": ""handle_excel"", ""method_name"": ""write_excel_cells"", ""module_name"": ""File_ReadWrite"", ""parameters_config"": {""workbook"": {""type"": ""variable"", ""value"": ""_workbook""}, ""col"": {""type"": ""variable"", ""value"": ""col_link""}, ""row"": {""type"": ""variable"", ""value"": ""_row""}, ""value"": {""type"": ""variable"", ""value"": ""url""}}, ""assign_to_variable_name"": null, ""workflow_pos"": [574, 3090]}"
step,"{""assign_to_variable_name"": null, ""class_name"": ""Chrome_selenium"", ""method_name"": ""close_driver"", ""module_name"": ""Chrome_selenium"", ""parameters_config"": {""driver"": {""type"": ""variable"", ""value"": ""_webdriver""}}, ""type"": ""step"", ""workflow_pos"": [574, 3210]}"
ELSE,"{""condition_config"": {""block_name"": null, ""condition"": {""left_operand"": {""type"": ""variable"", ""value"": ""url""}, ""operator"": ""is not"", ""right_operand"": {""type"": ""hardcoded"", ""value"": """"}}}, ""if_id"": ""if_5"", ""type"": ""ELSE""}"
step,"{""assign_to_variable_name"": null, ""class_name"": ""Bot_Flow_Control"", ""method_name"": ""do_nothing"", ""module_name"": ""Bot_GUI_Control"", ""parameters_config"": {}, ""type"": ""step"", ""workflow_pos"": [1168, 1490]}"
step,"{""assign_to_variable_name"": null, ""class_name"": ""handle_excel"", ""method_name"": ""write_excel_cells"", ""module_name"": ""File_ReadWrite"", ""parameters_config"": {""col"": {""type"": ""variable"", ""value"": ""col_price""}, ""row"": {""type"": ""variable"", ""value"": ""_row""}, ""value"": {""type"": ""hardcoded"", ""value"": ""Search not found DMX or TGGD""}, ""workbook"": {""type"": ""variable"", ""value"": ""_workbook""}}, ""type"": ""step"", ""workflow_pos"": [1168, 1610]}"
IF_END,"{""condition_config"": {""block_name"": null, ""condition"": {""left_operand"": {""type"": ""variable"", ""value"": ""url""}, ""operator"": ""is not"", ""right_operand"": {""type"": ""hardcoded"", ""value"": """"}}}, ""if_id"": ""if_5"", ""type"": ""IF_END"", ""workflow_pos"": [904, 3370]}"
step,"{""assign_to_variable_name"": null, ""class_name"": ""handle_excel"", ""method_name"": ""save_excel"", ""module_name"": ""File_ReadWrite"", ""parameters_config"": {""file_name"": {""type"": ""variable"", ""value"": ""excel_link""}, ""workbook"": {""type"": ""variable"", ""value"": ""_workbook""}}, ""type"": ""step"", ""workflow_pos"": [904, 3490]}"
ELSE,"{""condition_config"": {""block_name"": null, ""condition"": {""left_operand"": {""type"": ""variable"", ""value"": ""cells_price_value""}, ""operator"": ""=="", ""right_operand"": {""type"": ""hardcoded"", ""value"": null}}}, ""if_id"": ""if_4"", ""type"": ""ELSE""}"
step,"{""assign_to_variable_name"": null, ""class_name"": ""Bot_Flow_Control"", ""method_name"": ""do_nothing"", ""module_name"": ""Bot_GUI_Control"", ""parameters_config"": {}, ""type"": ""step"", ""workflow_pos"": [1498, 890]}"
IF_END,"{""condition_config"": {""block_name"": null, ""condition"": {""left_operand"": {""type"": ""variable"", ""value"": ""cells_price_value""}, ""operator"": ""=="", ""right_operand"": {""type"": ""hardcoded"", ""value"": null}}}, ""if_id"": ""if_4"", ""type"": ""IF_END"", ""workflow_pos"": [1234, 3650]}"
loop_end,"{""loop_config"": {""loop_name"": null, ""iteration_count_config"": {""type"": ""hardcoded"", ""value"": 2}, ""assign_iteration_to_variable"": ""_interate""}, ""loop_id"": ""loop_1"", ""type"": ""loop_end"", ""workflow_pos"": [1300, 3810]}"
